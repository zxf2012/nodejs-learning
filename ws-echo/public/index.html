<!doctype html>
<html>
    <head>
        <title>Websocket eco test</title>
        <script>
            window.onload = function () {
                var ws = new WebSocket('ws://localhost:3000');
                ws.onopen = function () {
                    // send first ping
                    ping();
                };
                ws.onmessage = function (ev) {
                    console.log('got: ' + ev.data);
                    document.getElementById('latency').innerHTML = new Date - lastMessage;
                    //ping();
                };
                function ping() {
                    lastMessage = +new Date;
                    //
                    ws.send('ping');
                };
            };
        </script>
    </head>
    <body>
        <h1>Websocket Echo</h1>
        <h2>Latency:<span id="latency"></span>ms</h2>
    </body>
</html>